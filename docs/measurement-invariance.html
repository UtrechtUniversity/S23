<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Measurement invariance | Utrecht Summer School S23</title>
  <meta name="description" content="Exercises for the computer labs of the Utrecht Summer School course ``Advanced course on using Mplus’’." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Measurement invariance | Utrecht Summer School S23" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Exercises for the computer labs of the Utrecht Summer School course ``Advanced course on using Mplus’’." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Measurement invariance | Utrecht Summer School S23" />
  
  <meta name="twitter:description" content="Exercises for the computer labs of the Utrecht Summer School course ``Advanced course on using Mplus’’." />
  

<meta name="author" content="Jeroen D. Mulder, Ellen L. Hamaker, Noémi Schuurman, and Caspar J. van Lissa" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="day-1-mplus-and-the-lisrel-model.html"/>
<link rel="next" href="path-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="font-awesome.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Home</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course</a></li>
<li class="chapter" data-level="1" data-path="day-1-mplus-and-the-lisrel-model.html"><a href="day-1-mplus-and-the-lisrel-model.html"><i class="fa fa-check"></i><b>1</b> Day 1: Mplus and the LISREL model</a>
<ul>
<li class="chapter" data-level="" data-path="measurement-invariance.html"><a href="measurement-invariance.html"><i class="fa fa-check"></i>Measurement invariance</a>
<ul>
<li class="chapter" data-level="" data-path="measurement-invariance.html"><a href="measurement-invariance.html#getting-started"><i class="fa fa-check"></i>Getting started</a></li>
<li class="chapter" data-level="" data-path="measurement-invariance.html"><a href="measurement-invariance.html#step-1-configural-invariance"><i class="fa fa-check"></i>Step 1: Configural invariance</a></li>
<li class="chapter" data-level="" data-path="measurement-invariance.html"><a href="measurement-invariance.html#step-2-weak-factorial-invariance"><i class="fa fa-check"></i>Step 2: Weak factorial invariance</a></li>
<li class="chapter" data-level="" data-path="measurement-invariance.html"><a href="measurement-invariance.html#step-3-strong-factorial-invariance"><i class="fa fa-check"></i>Step 3: Strong factorial invariance</a></li>
<li class="chapter" data-level="" data-path="measurement-invariance.html"><a href="measurement-invariance.html#alternative-way-of-scaling"><i class="fa fa-check"></i>Alternative way of scaling</a></li>
<li class="chapter" data-level="" data-path="measurement-invariance.html"><a href="measurement-invariance.html#full-model"><i class="fa fa-check"></i>Full model</a></li>
<li class="chapter" data-level="" data-path="measurement-invariance.html"><a href="measurement-invariance.html#conclusion"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="path-analysis.html"><a href="path-analysis.html"><i class="fa fa-check"></i>Path analysis</a>
<ul>
<li class="chapter" data-level="" data-path="path-analysis.html"><a href="path-analysis.html#conclusion-1"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-2-latent-growth-curve-modeling-lgcm.html"><a href="day-2-latent-growth-curve-modeling-lgcm.html"><i class="fa fa-check"></i><b>2</b> Day 2: Latent growth curve modeling (LGCM)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exercise-1-burn-survivors.html"><a href="exercise-1-burn-survivors.html"><i class="fa fa-check"></i><b>2.1</b> Exercise 1: Burn survivors</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="exercise-1-burn-survivors.html"><a href="exercise-1-burn-survivors.html#exercise-1a-specifying-a-lgcm"><i class="fa fa-check"></i><b>2.1.1</b> Exercise 1a: Specifying a LGCM</a></li>
<li class="chapter" data-level="2.1.2" data-path="exercise-1-burn-survivors.html"><a href="exercise-1-burn-survivors.html#exercise-1b-adding-covariates"><i class="fa fa-check"></i><b>2.1.2</b> Exercise 1b: Adding covariates</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="exercise-2-alcohol-use.html"><a href="exercise-2-alcohol-use.html"><i class="fa fa-check"></i><b>2.2</b> Exercise 2: Alcohol use</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="exercise-2-alcohol-use.html"><a href="exercise-2-alcohol-use.html#exercise-2a-specify-a-lgcm"><i class="fa fa-check"></i><b>2.2.1</b> Exercise 2a: Specify a LGCM</a></li>
<li class="chapter" data-level="2.2.2" data-path="exercise-2-alcohol-use.html"><a href="exercise-2-alcohol-use.html#exercise-2b-predicting-growth"><i class="fa fa-check"></i><b>2.2.2</b> Exercise 2b: Predicting growth</a></li>
<li class="chapter" data-level="2.2.3" data-path="exercise-2-alcohol-use.html"><a href="exercise-2-alcohol-use.html#exercise-2c-categorical-distal-outcome"><i class="fa fa-check"></i><b>2.2.3</b> Exercise 2c: Categorical distal outcome</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="exercise-3-level-and-shape-parameterization.html"><a href="exercise-3-level-and-shape-parameterization.html"><i class="fa fa-check"></i><b>2.3</b> Exercise 3: Level and shape parameterization</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="exercise-3-level-and-shape-parameterization.html"><a href="exercise-3-level-and-shape-parameterization.html#exercise-3a"><i class="fa fa-check"></i><b>2.3.1</b> Exercise 3a</a></li>
<li class="chapter" data-level="2.3.2" data-path="exercise-3-level-and-shape-parameterization.html"><a href="exercise-3-level-and-shape-parameterization.html#exercise-3b"><i class="fa fa-check"></i><b>2.3.2</b> Exercise 3b</a></li>
<li class="chapter" data-level="2.3.3" data-path="exercise-3-level-and-shape-parameterization.html"><a href="exercise-3-level-and-shape-parameterization.html#exercise-3c"><i class="fa fa-check"></i><b>2.3.3</b> Exercise 3c</a></li>
<li class="chapter" data-level="2.3.4" data-path="exercise-3-level-and-shape-parameterization.html"><a href="exercise-3-level-and-shape-parameterization.html#exercise-3d"><i class="fa fa-check"></i><b>2.3.4</b> Exercise 3d</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="exercise-4-latent-growth-curve-model-on-gpa-data.html"><a href="exercise-4-latent-growth-curve-model-on-gpa-data.html"><i class="fa fa-check"></i><b>2.4</b> Exercise 4: Latent growth curve model on GPA data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="exercise-4-latent-growth-curve-model-on-gpa-data.html"><a href="exercise-4-latent-growth-curve-model-on-gpa-data.html#exercise-4a"><i class="fa fa-check"></i><b>2.4.1</b> Exercise 4a</a></li>
<li class="chapter" data-level="2.4.2" data-path="exercise-4-latent-growth-curve-model-on-gpa-data.html"><a href="exercise-4-latent-growth-curve-model-on-gpa-data.html#exercise-4b"><i class="fa fa-check"></i><b>2.4.2</b> Exercise 4b</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day-3-longitudinal-mixture-modeling.html"><a href="day-3-longitudinal-mixture-modeling.html"><i class="fa fa-check"></i><b>3</b> Day 3: Longitudinal mixture modeling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="exercise-1-latent-growth-mixture-modeling.html"><a href="exercise-1-latent-growth-mixture-modeling.html"><i class="fa fa-check"></i><b>3.1</b> Exercise 1: Latent growth (mixture) modeling</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="exercise-1-latent-growth-mixture-modeling.html"><a href="exercise-1-latent-growth-mixture-modeling.html#exercise-1a-exploratory-lcga"><i class="fa fa-check"></i><b>3.1.1</b> Exercise 1a: Exploratory LCGA</a></li>
<li class="chapter" data-level="3.1.2" data-path="exercise-1-latent-growth-mixture-modeling.html"><a href="exercise-1-latent-growth-mixture-modeling.html#exercise-1b"><i class="fa fa-check"></i><b>3.1.2</b> Exercise 1b</a></li>
<li class="chapter" data-level="3.1.3" data-path="exercise-1-latent-growth-mixture-modeling.html"><a href="exercise-1-latent-growth-mixture-modeling.html#exercise-1c-growth-mixture-models"><i class="fa fa-check"></i><b>3.1.3</b> Exercise 1c: Growth mixture models</a></li>
<li class="chapter" data-level="3.1.4" data-path="exercise-1-latent-growth-mixture-modeling.html"><a href="exercise-1-latent-growth-mixture-modeling.html#exercise-1d-model-predicted-trajectory-plots"><i class="fa fa-check"></i><b>3.1.4</b> Exercise 1d: Model-predicted trajectory plots</a></li>
<li class="chapter" data-level="3.1.5" data-path="exercise-1-latent-growth-mixture-modeling.html"><a href="exercise-1-latent-growth-mixture-modeling.html#exercise-1e"><i class="fa fa-check"></i><b>3.1.5</b> Exercise 1e</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="exercise-2-latent-transition-analysis-lta.html"><a href="exercise-2-latent-transition-analysis-lta.html"><i class="fa fa-check"></i><b>3.2</b> Exercise 2: Latent transition analysis (LTA)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="exercise-2-latent-transition-analysis-lta.html"><a href="exercise-2-latent-transition-analysis-lta.html#exercise-2a"><i class="fa fa-check"></i><b>3.2.1</b> Exercise 2a</a></li>
<li class="chapter" data-level="3.2.2" data-path="exercise-2-latent-transition-analysis-lta.html"><a href="exercise-2-latent-transition-analysis-lta.html#exercise-2b"><i class="fa fa-check"></i><b>3.2.2</b> Exercise 2b</a></li>
<li class="chapter" data-level="3.2.3" data-path="exercise-2-latent-transition-analysis-lta.html"><a href="exercise-2-latent-transition-analysis-lta.html#exercise-2c"><i class="fa fa-check"></i><b>3.2.3</b> Exercise 2c</a></li>
<li class="chapter" data-level="3.2.4" data-path="exercise-2-latent-transition-analysis-lta.html"><a href="exercise-2-latent-transition-analysis-lta.html#exercise-2d"><i class="fa fa-check"></i><b>3.2.4</b> Exercise 2d</a></li>
<li class="chapter" data-level="3.2.5" data-path="exercise-2-latent-transition-analysis-lta.html"><a href="exercise-2-latent-transition-analysis-lta.html#exercise-2e"><i class="fa fa-check"></i><b>3.2.5</b> Exercise 2e</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="day-4-cross-lagged-relations.html"><a href="day-4-cross-lagged-relations.html"><i class="fa fa-check"></i><b>4</b> Day 4: Cross-lagged relations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html"><i class="fa fa-check"></i><b>4.1</b> Quasi-simplex model</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-a"><i class="fa fa-check"></i><b>4.1.1</b> Exercise A</a></li>
<li class="chapter" data-level="4.1.2" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-b"><i class="fa fa-check"></i><b>4.1.2</b> Exercise B</a></li>
<li class="chapter" data-level="4.1.3" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-c"><i class="fa fa-check"></i><b>4.1.3</b> Exercise C</a></li>
<li class="chapter" data-level="4.1.4" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-d"><i class="fa fa-check"></i><b>4.1.4</b> Exercise D</a></li>
<li class="chapter" data-level="4.1.5" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-e"><i class="fa fa-check"></i><b>4.1.5</b> Exercise E</a></li>
<li class="chapter" data-level="4.1.6" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-f"><i class="fa fa-check"></i><b>4.1.6</b> Exercise F</a></li>
<li class="chapter" data-level="4.1.7" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-g"><i class="fa fa-check"></i><b>4.1.7</b> Exercise G</a></li>
<li class="chapter" data-level="4.1.8" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-h"><i class="fa fa-check"></i><b>4.1.8</b> Exercise H</a></li>
<li class="chapter" data-level="4.1.9" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-i"><i class="fa fa-check"></i><b>4.1.9</b> Exercise I</a></li>
<li class="chapter" data-level="4.1.10" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-j"><i class="fa fa-check"></i><b>4.1.10</b> Exercise J</a></li>
<li class="chapter" data-level="4.1.11" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-k"><i class="fa fa-check"></i><b>4.1.11</b> Exercise K</a></li>
<li class="chapter" data-level="4.1.12" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-l"><i class="fa fa-check"></i><b>4.1.12</b> Exercise L</a></li>
<li class="chapter" data-level="4.1.13" data-path="quasi-simplex-model.html"><a href="quasi-simplex-model.html#exercise-m"><i class="fa fa-check"></i><b>4.1.13</b> Exercise M</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="clpm-ri-clpm.html"><a href="clpm-ri-clpm.html"><i class="fa fa-check"></i><b>4.2</b> CLPM &amp; RI-CLPM</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="clpm-ri-clpm.html"><a href="clpm-ri-clpm.html#exercise-a-1"><i class="fa fa-check"></i><b>4.2.1</b> Exercise A</a></li>
<li class="chapter" data-level="4.2.2" data-path="clpm-ri-clpm.html"><a href="clpm-ri-clpm.html#exercise-b-1"><i class="fa fa-check"></i><b>4.2.2</b> Exercise B</a></li>
<li class="chapter" data-level="4.2.3" data-path="clpm-ri-clpm.html"><a href="clpm-ri-clpm.html#exercise-c-1"><i class="fa fa-check"></i><b>4.2.3</b> Exercise C</a></li>
<li class="chapter" data-level="4.2.4" data-path="clpm-ri-clpm.html"><a href="clpm-ri-clpm.html#exercise-d-1"><i class="fa fa-check"></i><b>4.2.4</b> Exercise D</a></li>
<li class="chapter" data-level="4.2.5" data-path="clpm-ri-clpm.html"><a href="clpm-ri-clpm.html#exercise-e-1"><i class="fa fa-check"></i><b>4.2.5</b> Exercise E</a></li>
<li class="chapter" data-level="4.2.6" data-path="clpm-ri-clpm.html"><a href="clpm-ri-clpm.html#exercise-f-1"><i class="fa fa-check"></i><b>4.2.6</b> Exercise F</a></li>
<li class="chapter" data-level="4.2.7" data-path="clpm-ri-clpm.html"><a href="clpm-ri-clpm.html#exercise-g-1"><i class="fa fa-check"></i><b>4.2.7</b> Exercise G</a></li>
<li class="chapter" data-level="4.2.8" data-path="clpm-ri-clpm.html"><a href="clpm-ri-clpm.html#exercise-h-1"><i class="fa fa-check"></i><b>4.2.8</b> Exercise H</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Utrecht Summer School S23</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="measurement-invariance" class="section level2 unnumbered hasAnchor">
<h2>Measurement invariance<a href="measurement-invariance.html#measurement-invariance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Measurement invariance is important if we want to compare individuals from different groups, or the means of different groups. Measurement invariance implies that two individuals from different groups who have the same latent score, have the same expected observed scores. It also means that if there are observed mean differences between two groups, these can only stem from latent mean differences.</p>
<p>When measurement invariance does not hold, we call the test (i.e., measurement instrument) biased. We may then look for the source of the bias, and try to account for this in our analyses.</p>
<p>Here we will show how to specify a sequence of models to test whether measurement invariance holds. These steps include:</p>
<ul>
<li><p><em>configural invariance</em>; this implies the same model in each group without any constraints across the groups</p></li>
<li><p><em>weak factorial invariance</em>; this implies the factor loadings are constrained across the groups to be the same</p></li>
<li><p><em>strong factorial invariance</em>; this implies the factor loadings and the intercepts are constrained to be the same across the groups, while the latent means in the second (and subsequent) group(s) are allowed to be estimated freely</p></li>
</ul>
<div id="getting-started" class="section level3 unnumbered hasAnchor">
<h3>Getting started<a href="measurement-invariance.html#getting-started" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We start with drawing the model as a path diagram. The data come from:</p>
<p>Sabatelli, R. M., and Bartle-Haring (2003). Family-of-origin and adjustment in married couples. <em>Journal of Marriage and Family, 65</em>, 159-169. <a href="https://doi.org/10.1111/j.1741-3737.2003.00159.x" class="uri">https://doi.org/10.1111/j.1741-3737.2003.00159.x</a></p>
<p>They obtained measures from 103 married couples regarding their marital adjustment and their family of origin. Here we analyze these data using a multiple group approach, although the individuals in the two groups are not independent of each other, and there are other approaches that would be more appropriate for this (such as described in the original paper, where the cases are couples, and the data of each couple consists of variables measured in the hubsand and other variables are measured in the wives).</p>
<p>The variables included are:</p>
<ul>
<li><p>Satisfaction (S): higher levels imply fewer complaints</p></li>
<li><p>Intimacy (I): higher scores imply more self-disclosures, experiences of empathy and affection, and feelings of emotional closeness toward the marital partner</p></li>
<li><p>Father (F): higher scores imply a better relationship between the participant and his/her father</p></li>
<li><p>Mother (M): higher scores imply a better relationship between the participant and his/her mother</p></li>
<li><p>Father-mother (FM): higher scores a better relationship between the parents of the participant</p></li>
</ul>
<p>The idea is that the first two variables measure Marital Adjustment (MA) and the latter three variables measure the quality of relationships in the Family of Origin (FO). Furthermore, it is assumed that FO is a predictor of MA.</p>
<div id="question-1" class="section level4 unnumbered hasAnchor">
<h4>Question 1<a href="measurement-invariance.html#question-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Draw the path diagram for this structural equation model.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>Measurement part of the model: S and I are indicators of MA; F, M, and FM are indicators of FO.</p>
<p>Structural part of the model: MA is regressed on FO.</p>
<p><img src="figures/PathDiagramMeasInv.png" width="400" /></p>
<p>Before doing the actual model that includes the structural relation between the latent variables, we start with only the measurement model; this means that we specify a two-factor model in which the latent variables are allowed to covary (i.e., a two-headed arrow between MA and FO). We use this model to investigate whether strong factorial invariance holds by testing whether the assumptions of this model hold.</p>
</div>
<div id="question-2" class="section level4 unnumbered hasAnchor">
<h4>Question 2<a href="measurement-invariance.html#question-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The data for this exercise are included in the file named Family.dat; note it only contains the summary statistics, that is, it contains the means, standard deviations, and correlation matrices for each group (men first, then women), that were printed in the original paper. Have a look at these.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>You can open the data either in Mplus, or with a program like notepad. This is what you see:</p>
<pre><code>161.779 138.382 86.229 86.392 85.046
32.936 22.749 13.390 13.679 14.382
1
.740 1
.265 .422 1
.305 .401 .791 1
.315 .351 .662 .587 1
155.547 137.971 82.764 85.494 81.003
31.168 20.094 11.229 11.743 13.220
1
.658 1
.288 .398 1
.171 .295 .480 1
.264 .305 .554 .422 1</code></pre>
</div>
<div id="question-3" class="section level4 unnumbered hasAnchor">
<h4>Question 3<a href="measurement-invariance.html#question-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Typically when you have data, you will have the raw data. In that case you will have the observed variables and a grouping variable in one file. See example 5.14 in the Mplus Users Guide for how to specify the <code>DATA</code> and <code>VARIABLE</code> commands in that case.</p>
<p>Here we only have the summary data. To specify the <code>DATA</code> and <code>VARIABLE</code> commands in this case, use:</p>
<pre><code>DATA:   NGROUPS ARE 2;
        TYPE IS MEANS STD CORR;
        FILE IS Family.dat;
        NOBSERVATIONS ARE 103 103;

VARIABLE:   NAMES ARE S I F M FM;</code></pre>
<p>We will begin with using the automatic option in Mplus that allows us to run all three models that are needed to investigate measurement invariance. This can be done by adding:</p>
<pre><code>    ANALYSIS:   MODEL = CONFIGURAL METRIC SCALAR;</code></pre>
<p>where <code>CONFIGURAL</code> is the model without any constraints across the groups; <code>METRIC</code> is the model we refer to as <em>weak factorial invariance</em>, that is, equal factor loadings across groups; and <code>SCALAR</code> is what we refer to as <em>strong factorial invariance</em>, that is, equal factor loadings and intercepts across groups, and freely estimated latent means in group 2 (and subsequent groups, if there are any).</p>
<p>Use the code above, and add:</p>
<ul>
<li><p><code>TITLE</code> command</p></li>
<li><p><code>MODEL</code> command, in which you just specify the general factor model (so no need to specify separate models for separate groups!)</p></li>
<li><p><code>OUTPUT</code> command</p></li>
</ul>
Run the model and check the output. Describe what you see.
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>In the top menu in Mplus you can change the format of the output file by going to <code>Mplus</code> and choosing <code>HTML output</code>, and then run the model. This will result in output with links that makes it easier to navigate through it. At the beginning of the output, you get to see:</p>
<pre><code>    OUTPUT SECTIONS

    Input Instructions 
    Input Warnings And Errors 
    Summary Of Analysis 
    Sample Statistics 
    Model Fit Information 
    - For The Configural Model 
    - For The Metric Model 
    - For The Scalar Model 
    Model Results 
    - For The Configural Model 
    - For The Metric Model 
    - For The Scalar Model 
    Technical 1 Output 
    - For The Configural Model 
    - For The Metric Model 
    - For The Scalar Model 
    Technical 9 Output </code></pre>
<p>Hence, we see that for each of the three models we get information about model fit, we get the parameter estimates, and the additional output (here, we asked for <code>TECH1</code>). We also get <code>TECH9</code> which contains the warnings for the three models.</p>
<p>While this automatic option is of course very convenient in practice, we will now focus in this exercise on how to specify and run these three models ourselves. The point of this is that we see how we can overrule defaults in Mplus, and we consider the models one by one (and check the <code>TECH1</code> output), and consider alternative ways of scaling these models.</p>
</div>
</div>
<div id="step-1-configural-invariance" class="section level3 unnumbered hasAnchor">
<h3>Step 1: Configural invariance<a href="measurement-invariance.html#step-1-configural-invariance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="question-4" class="section level4 unnumbered hasAnchor">
<h4>Question 4<a href="measurement-invariance.html#question-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If we specify the model for configural invariance:</p>
<ul>
<li><p>how many sample statistics are there?</p></li>
<li><p>how many free parameters are there?</p></li>
<li><p>how many df are there?</p></li>
</ul>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p><em>Sample statistics</em>. We have 5 observed variables in each group. Hence, we have 5*6/2 = 15 unique elements in the covariance matrix S for each group, plus 5 observed means, so 20 sample statistics per group. That makes 40 sample statistics in total.</p>
<p><em>Free parameter</em>. In each group we estimate:</p>
<ul>
<li><p>3 factor loadings (there are 5 factor loadings, but 2 are used for scaling)</p></li>
<li><p>2 factor variances</p></li>
<li><p>1 factor covariance</p></li>
<li><p>5 residual variances</p></li>
<li><p>5 intercepts</p></li>
</ul>
<p>That makes 16 parameters per group; hence, 32 free parameters in total.</p>
<p><em>Degrees of freedom</em>. The degrees of freedom are therefore: df = 40-32=6.</p>
</div>
<div id="question-5" class="section level4 unnumbered hasAnchor">
<h4>Question 5<a href="measurement-invariance.html#question-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Specify the two-factor model for configural invariance.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<pre><code>    MODEL:      MA BY S I;
                FO BY F M FM; 

    MODEL g2:   MA BY S@1 I;
                FO BY F@1 M FM;
                [S I F M FM];
                [MA@0 FO@0];</code></pre>
<p>where the first <code>MODEL:</code> command is the general model specification, and the second part <code>MODEL g2;</code> is overruling the multiple group factor analysis defaults through:</p>
<ul>
<li><p>freeing the factor loadings (so they are not identical to the factor loadings in g1), and using <code>@1</code> to ensure the factors are scaled</p></li>
<li><p>freeing the intercepts in the second group (so they are not identical to the intercepts in g1)</p></li>
<li><p>fixing the latent means to zero (to ensure identification)</p></li>
</ul>
<p>Alternatively, one could also say:</p>
<pre><code>    MODEL:      MA BY S I;
                FO BY F M FM; 

    MODEL g2:   MA BY I;
                FO BY M FM;
                [S I F M FM];
                [MA@0 FO@0];</code></pre>
<p>Here, we are doing the same thing, but not overruling the default for the factor loadings of the first indicator of each latent variable (hence the initial scaling remains in tact).</p>
<p>In addition to this <code>MODEL</code> command, we specify the <code>OUTPUT</code> command as:</p>
<pre><code>    OUTPUT: TECH1 MOD(4);</code></pre>
</div>
<div id="question-6" class="section level4 unnumbered hasAnchor">
<h4>Question 6<a href="measurement-invariance.html#question-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Run this model, and check whether the <code>TECH1</code> output matches your answer under Question 4 regarding where the free parameters are. Also check the warning(s); is there a reason for concern?</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>We get this warning:</p>
<pre><code>    THE MODEL ESTIMATION TERMINATED NORMALLY

        WARNING:  THE RESIDUAL COVARIANCE MATRIX (THETA) IN GROUP G1 IS NOT
        POSITIVE DEFINITE.  THIS COULD INDICATE A NEGATIVE VARIANCE/RESIDUAL
        VARIANCE FOR AN OBSERVED VARIABLE, A CORRELATION GREATER OR EQUAL TO ONE
        BETWEEN TWO OBSERVED VARIABLES, OR A LINEAR DEPENDENCY AMONG MORE THAN TWO
        OBSERVED VARIABLES.  CHECK THE RESULTS SECTION FOR MORE INFORMATION.
        PROBLEM INVOLVING VARIABLE I.</code></pre>
<p>This implies that the residual covariance matrix contains a combination of numbers (i.e., parameter estimates) that are not possible in a covariance matrix. We can start with checking the relevant parameter estimates in the first group:</p>
<pre><code>     Residual Variances
        S                528.470    130.512      4.049      0.000
        I                -39.883    109.198     -0.365      0.715
        F                 21.613     10.983      1.968      0.049
        M                 53.509     11.710      4.570      0.000
        FM               103.074     16.168      6.375      0.000</code></pre>
<p>It shows that the residual variance for the indicator I (intimacy) is negative; this is not possible (as variances are by definition zero or larger). This is referred to as a Heywood case, and is typically interpreted as meaning that the model is too complicated for the data (for instance because the model is really wrong, or because the sample size is too small). I is an indicator of MA, which only has one other indicator (i.e., S); this is often a difficult situation in terms of estimation.</p>
<p>One action we could take is setting this residual variance to zero (note the parameter is not significantly different from zero). That would mean this variable is a perfect indicator of the latent variable MA, as there would be no measurement error at all; this would in turn mean we only need this indicator, and there is no need for the second indicator to measure the latent variable.</p>
<p>But for now, we will just leave the variable in, and consider the model fit before moving on to testing weak factorial invariance.</p>
</div>
<div id="question-7" class="section level4 unnumbered hasAnchor">
<h4>Question 7<a href="measurement-invariance.html#question-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For now, we ignore this warning. What is the model fit?</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<pre><code>    Chi-Square Test of Model Fit

              Value                              6.025
              Degrees of Freedom                     8    
              P-Value                           0.6444</code></pre>
<p>The chi-square test indicates the model fits well (note btw that the degrees of freedom are indeed 8). We see this chi-square is simply the sum of the chi-squares that are obtained for each group, as presented in the output:</p>
<pre><code>    Chi-Square Contribution From Each Group

              G1                                 4.688
              G2                                 1.337</code></pre>
<p>The other fit measures also indicate the model fits very well:</p>
<pre><code>    RMSEA (Root Mean Square Error Of Approximation)

              Estimate                           0.000
              90 Percent C.I.                    0.000  0.095
              Probability RMSEA &lt;= .05           0.786

    CFI/TLI

              CFI                                1.000
              TLI                                1.000

    SRMR (Standardized Root Mean Square Residual)

              Value                              0.019</code></pre>
</div>
</div>
<div id="step-2-weak-factorial-invariance" class="section level3 unnumbered hasAnchor">
<h3>Step 2: Weak factorial invariance<a href="measurement-invariance.html#step-2-weak-factorial-invariance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="question-8" class="section level4 unnumbered hasAnchor">
<h4>Question 8<a href="measurement-invariance.html#question-8" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, specify the model for weak factorial invariance. How many df would this model have? Run this model and report on the model fit.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>In the model for weak factorial invariance, we set the factor loadings invariant across groups, while not constraining the mean structure. In practice, this implies we no longer have to overrule the defaults for the factor loadings, but we still need to overrule the defaults for the intercepts and latent means. Hence, the model specification becomes:</p>
<pre><code>    MODEL:      MA BY S I;
                FO BY F M FM; 

    MODEL g2:   [S I F M FM];
                [MA@0 FO@0];</code></pre>
<p>While in the previous model we were estimating 3 factor loadings in each group (so 6 factor loadings in total), we now estimate 3 factor loadings for both groups. Hence, this model has 3 free parameters <em>less</em>, and thus 3 df <em>more</em> than the model for configural invariance; the df should thus be 8+3=11. This also becomes clear when looking at the <code>TECH1</code> output of this model (see the numbers that identify the free parameters in the matrix <code>LAMBDA</code>).</p>
<p>We see this in the chi-square test:</p>
<pre><code>    Chi-Square Test of Model Fit

              Value                              8.735
              Degrees of Freedom                    11
              P-Value                           0.6463</code></pre>
<p>We see indeed the number of df is 11.</p>
</div>
<div id="question-9" class="section level4 unnumbered hasAnchor">
<h4>Question 9<a href="measurement-invariance.html#question-9" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Do a chi-square difference test to determine whether the assumption of weak factorial invariance (i.e., equal factor loadings across groups) holds.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p><span class="math inline">\(\Delta \chi^2 = 8.735 - 6.025 = 2.710\)</span></p>
<p><span class="math inline">\(\Delta df = 11 - 8 = 3\)</span></p>
<p>Hence, the chi-square difference is 2.710 with df=3. The p-value for this is 0.4385 (for an online chi-square calculator, see for instance: <a href="https://www.fourmilab.ch/rpkp/experiments/analysis/chiCalc.html" class="uri">https://www.fourmilab.ch/rpkp/experiments/analysis/chiCalc.html</a>).</p>
<p>This means that our H0 (i.e., weak factorial invariance) is not rejected. Put differently, the constraints for weak factorial invariance can be imposed.</p>
</div>
</div>
<div id="step-3-strong-factorial-invariance" class="section level3 unnumbered hasAnchor">
<h3>Step 3: Strong factorial invariance<a href="measurement-invariance.html#step-3-strong-factorial-invariance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="question-10" class="section level4 unnumbered hasAnchor">
<h4>Question 10<a href="measurement-invariance.html#question-10" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, specify the model for strong factorial invariance. Again, indicate how many df this model will have, run the model, and report on the model fit.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>Strong factorial invariance is the default multiple group factor model that Mplus runs. Hence, it does not require us to overrule any of its defaults. Compared to the previous model, this means that it will constrain all five intercepts to be identical across the two groups, but at the same time, it will freely estimate the two latent means in the second group. Hence, the difference in df is 5-2=3; the new model with have 3 df more than the one we had before.</p>
<p>The <code>MODEL</code> command for this model is very simple; we only need:</p>
<pre><code>    MODEL:      MA BY S I;
                FO BY F M FM; </code></pre>
<p>The chi-square of this model is:</p>
<pre><code>    Chi-Square Test of Model Fit

             Value                             15.647
             Degrees of Freedom                    14
             P-Value                           0.3354</code></pre>
<p>We see that indeed the df are 3 more than before (11+3=14).</p>
</div>
<div id="exercise-11" class="section level4 unnumbered hasAnchor">
<h4>Exercise 11<a href="measurement-invariance.html#exercise-11" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Do a chi-square difference test to determine whether the assumption of strong factorial invariance (i.e., equal intercepts; only latent mean differences) holds.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>We compare the current model fit to that of the previous model (i.e., the one for weak factorial invariance), to determine whether the additional constraints are tenable.</p>
<p>Hence we have:</p>
<p><span class="math inline">\(\Delta \chi^2 = 15.647 - 8.735 = 6.912\)</span></p>
<p><span class="math inline">\(\Delta df = 14 - 11 = 3\)</span></p>
<p>A chi-square difference test of 6.912 with 3 df has a p-value of 0.0748. Hence, again, the H0 is not rejected, which now means we can assume that strong factorial invariance holds.</p>
</div>
<div id="exercise-12" class="section level4 unnumbered hasAnchor">
<h4>Exercise 12<a href="measurement-invariance.html#exercise-12" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Check the <code>TECH1</code> output for the latter model. How do you see the constraints that were imposed?</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>You can see the intercepts and factor loadings are constrained across the two groups, because the same numbers are used to show which ones are estimated freely:</p>
<pre><code>               NU
                  S             I             F             M             FM
                 ________      ________      ________      ________      ________
                      1             2             3             4             5


               LAMBDA
                 MA            FO
                  ________      ________
     S                  0             0
     I                  6             0
     F                  0             0
     M                  0             7
     FM                 0             8</code></pre>
</div>
</div>
<div id="alternative-way-of-scaling" class="section level3 unnumbered hasAnchor">
<h3>Alternative way of scaling<a href="measurement-invariance.html#alternative-way-of-scaling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Above, we have used the usual way of scaling:</p>
<ul>
<li><p>first factor loading of each latent variable fixed to 1 (in each group)</p></li>
<li><p>all latent means fixed to 0 (in each group), combined with estimating the intercepts for the observed variables freely (in each group)</p></li>
</ul>
<p>In this case, the step from configural to weak factorial invariance now consists of only adding more constraints, which makes it easy to see these two models are nested (i.e., the model for weak factorial invariance is nested under the model for configural invariance).</p>
<p>However, it is less obvious that the model for strong factorial invariance is nested under the model for weak factorial invariance, because it includes constraining parameters (i.e., the intercepts have to be equal across groups), but also requires freeing parameters (i.e., the latent means in the second group are freed).</p>
<p>To ensure that these models are nested, we use an alternative way of specifying these models, based on a different way of scaling. The <strong>key issue</strong> here is that these alternative model specification are simply reparameterizations of the the same models; they are equivalent models, as we can see because they lead to the <em>exact same model fit</em>.</p>
<div id="question-13" class="section level4 unnumbered hasAnchor">
<h4>Question 13<a href="measurement-invariance.html#question-13" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Instead of scaling with the latent means fixed to zero and the intercepts all estimated freely, scale the latent variable in the model for configural invariance through setting the intercept for the first indicator to zero, while allowing the latent mean to be estimated freely. Compare the model fit to the one obtained above for the configural invariance model.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>The <code>MODEL</code> command can be specified as:</p>
<pre><code>      MODEL:        MA BY S I;
                    FO BY F M FM;

      MODEL g1:     [S@0 F@0];
                    [MA FO];

      MODEL g2:     MA BY S@1 I;
                    FO BY F@1 M FM;
                    [S@0 I F@0 M FM];</code></pre>
<p>When running the model like this, it does not converge within the default number of iterations. We get this message</p>
<pre><code>         NO CONVERGENCE.  NUMBER OF ITERATIONS EXCEEDED.</code></pre>
<p>and there is no model fit, standard errors, or p-values. This can mean the model is too complicated. It can also mean you need to specify (better) starting values. As a first step, we can just increase the number of iterations, by adding:</p>
<pre><code>    ANALYSIS:   ITERATIONS ARE 20000;</code></pre>
<p>In this case, this solves it, that is, the model now converges. When considering the model fit, we see it is exactly the same as that of the model discussed in Question 7.</p>
<pre><code>    Chi-Square Test of Model Fit

              Value                              6.025
              Degrees of Freedom                     8    
              P-Value                           0.6444</code></pre>
<p>Because the chi-square is exactly the same (and the df), this implies these models are <em>statistically equivalent</em>; they are identical, just parameterized differently. You cannot distinguish between them on statistical grounds.</p>
<p>Hence, this shows that this alternative way of scaling the latent variables gives a model that is equivalent.</p>
</div>
<div id="question-14" class="section level4 unnumbered hasAnchor">
<h4>Question 14<a href="measurement-invariance.html#question-14" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, use this alternative way of scaling and specify the model for weak factorial invariance.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>The <code>MODEL</code> command can be specified as:</p>
<pre><code>      MODEL:        MA BY S I;
                    FO BY F M FM;

      MODEL g1:     [S@0 F@0];
                    [MA FO];

      MODEL g2:     [S@0 I F@0 M FM];</code></pre>
<p>That is, we no longer overrule the defaults for the factor loadings. Note that for this model to converge, we do not need to increase the number of iterations.</p>
<p>When considering the model fit, we see it is exactly the same as that of the model discussed in Question 8:</p>
<pre><code>    Chi-Square Test of Model Fit

              Value                              8.735
              Degrees of Freedom                    11
              P-Value                           0.6463</code></pre>
<p>This means that the current model is statistically equivalent to the model we had before to impose weak factorial invariance.</p>
</div>
<div id="question-15" class="section level4 unnumbered hasAnchor">
<h4>Question 15<a href="measurement-invariance.html#question-15" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>And now, the Moment Suprême: We will specify the model for strong factorial invariance using this alternative way of scaling. The <em>key</em> issue to notice here is that in going from weak factorial invariance to strong factorial invariance, we will now only add constraints, which makes it very clear that the latter model must be nested under the former.</p>
<p>Remember that before, we were adding constraints (i.e., fixing the intercepts to be identical across the groups), but also were freeing parameters (i.e., allowing the latent means in the second group to be estimated freely); this makes it difficult to see that the model for strong factorial invariance is nested under that of weak factorial invariance.</p>
<p>But with this alternative way of scaling, which leads to <em>statistically equivalant models</em> (i.e., models with the exact fit, and which are thus indistinguishable), we now only add constraints on parameters when going from weak to strong factorial invariance, such that it is very obvious that (and how) they are nested.</p>
<p>Specify the model for strong factorial invariance using this alternative way of scaling.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>The <code>MODEL</code> command can be specified as:</p>
<pre><code>      MODEL:        MA BY S I;
                    FO BY F M FM;

      MODEL g1:     [S@0 F@0];
                    [MA FO];

      MODEL g2:     [S@0 F@0];</code></pre>
<p>This model leads to the exactly same model fit as that of the model discussed in Question 10:</p>
<pre><code>    Chi-Square Test of Model Fit

              Value                             15.647
              Degrees of Freedom                    14
              P-Value                           0.3354</code></pre>
<p>This means that the current model is statistically equivalent to the model we had before to impose strong factorial invariance. This also means that we can now be certain that the model for strong factorial invariance is nested under the model for weak factorial invariance; this means we can do a chi-square difference test to compare them (as we already did above).</p>
</div>
<div id="question-16" class="section level4 unnumbered hasAnchor">
<h4>Question 16<a href="measurement-invariance.html#question-16" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>While this alternative way of specifying the series of models is useful to seeing their nestedness, the first way of specifying the models also has advantages. One of these advantages is that it requires fewer defaults to be overruled. But more importantly, it allows us to easily determine in the strong factorial invariance model whether there are latent mean differences between the groups. Report and interpret these.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>In the first approach, the model for strong factorial invariance is based on constraining the factor loadings and intercepts across the groups, and freeing the latent means in the second group, while the means in the first group are fixed to zero.</p>
<p>That is, for G1 we get:</p>
<pre><code>     Means
        MA                 0.000      0.000    999.000    999.000
        FO                 0.000      0.000    999.000    999.000</code></pre>
<p>and for G2 we get:</p>
<pre><code>     Means
        MA                -0.415      3.118     -0.133      0.894
        FO                -3.140      1.655     -1.898      0.058</code></pre>
<p>This implies that the significance test of the latter can be used to determine whether there are latent mean differences between the second and the first group. Here we get a p-value of 0.894 for MA, and a p-value of 0.058 for FO; hence for both we do not find evidence that they differ from zero, which means that for both we do not find evidence that the two groups differ.</p>
</div>
</div>
<div id="full-model" class="section level3 unnumbered hasAnchor">
<h3>Full model<a href="measurement-invariance.html#full-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As both the test for weak and for strong factorial invariance were non-significant, we can conclude that strong factorial invariance holds. This means we can compare individuals from these groups, and we can compare the means of these groups. It also means that the constructs “Marital Adjustment” and “Family of Origin” are measured in the same way in these two groups, and that we can specify a structural model for these latent variables in the two groups to investigate how they are related.</p>
<div id="question-17" class="section level4 unnumbered hasAnchor">
<h4>Question 17<a href="measurement-invariance.html#question-17" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Specify the model as initially intended, with FO as a predictor of MA at the latent level, while assuming strong factorial invariance.</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>The model is now specified as:</p>
<pre><code>    MODEL:      MA BY S I;
                FO BY F M FM; 
                MA ON FO;</code></pre>
</div>
<div id="question-18" class="section level4 unnumbered hasAnchor">
<h4>Question 18<a href="measurement-invariance.html#question-18" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Run this model, and compare the model fit to that of the model for strong factorial invariance that we had before. What do you conclude?</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>These models have the exact same model fit (same chi-square and df). This means these models are statistically equivalent. Hence, it does not matter whether you estimate the covariance between the two latent variables, or a regression coefficient.</p>
</div>
<div id="question-19" class="section level4 unnumbered hasAnchor">
<h4>Question 19<a href="measurement-invariance.html#question-19" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When comparing the <code>TECH1</code> output of these two models, what difference do you spot?</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>In the two-factor model we have for G1:</p>
<pre><code>              BETA
                  MA            FO
                  ________      ________
     MA                 0             0
     FO                 0             0


               PSI
                  MA            FO
                  ________      ________
     MA                14
     FO                15            16</code></pre>
<p>that is, no structural parameters, and a covariance is Psi; in contrast in the regression model we have for G1:</p>
<pre><code>               BETA
                  MA            FO
                  ________      ________
     MA                 0            14
     FO                 0             0


               PSI
                  MA            FO
                  ________      ________
     MA                15
     FO                 0            16</code></pre>
<p>showing there is a structural parameter in Beta (going to MA, coming from FO), and there is no covariance estimated in Psi.</p>
<p>The same is true for G2.</p>
</div>
<div id="question-20" class="section level4 unnumbered hasAnchor">
<h4>Question 20<a href="measurement-invariance.html#question-20" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As a final step, we want to investigate whether the regression coefficient is different in the two groups or not. How can you investigate this?</p>
<details>
<summary>
<b>Click to show answers</b>
</summary>
<p>In the model above, the regression parameter was not constrained across the groups. We can now specify a model in which we constrain the parameter to be invariant across the two groups; that model will be nested under the previous model, and we can thus do a chi-square difference test to see whether the constraint holds.</p>
<p>To constrain the parameter across the groups, we only have to give it a label (i.e., a name). Here we will give it the label <code>c</code> (you could als give it a longer name, such as <code>coeff</code>). The model is now specified as:</p>
<pre><code>    MODEL:      MA BY S I;
                FO BY F M FM; 
                MA ON FO (c);</code></pre>
<p>To see that this leads to having the same regression coefficient in both groups, we can check the <code>TECH1</code> output. For G1 we have (only showing part of it):</p>
<pre><code>               ALPHA
                  MA            FO
                  ________      ________
                      0             0


               BETA
                   MA            FO
                  ________      ________
     MA                 0            14
     FO                 0             0


              PSI
                 MA            FO
                  ________      ________
     MA                15
     FO                 0            16</code></pre>
<p>and for G2:</p>
<pre><code>               ALPHA
                  MA            FO
                  ________      ________
                     22            23


              BETA
                  MA            FO
                  ________      ________
     MA                 0            14
     FO                 0             0


               PSI
                  MA            FO
                  ________      ________
     MA                24
     FO                 0            25</code></pre>
<p>It shows that the structural parameter in both cases is the same parameter (number 14).</p>
<p>The model fit is:</p>
<pre><code>    Chi-Square Test of Model Fit

              Value                             16.315
              Degrees of Freedom                    15
              P-Value                           0.3614</code></pre>
<p>showing it has 1 df more than the model we had before (because we estimate 1 parameter less). Doing a chi-square difference test we get:</p>
<p><span class="math inline">\(\Delta \chi^2 = 16.315 - 15.647 = 0.688\)</span> with <span class="math inline">\(df-1\)</span>, which gives a p-value of 0.4137, which means the test is not significant. Hence, H0 does not have to be rejected, and we can therefore assume that the regression coefficient is identical across the two groups.</p>
</div>
</div>
<div id="conclusion" class="section level3 unnumbered hasAnchor">
<h3>Conclusion<a href="measurement-invariance.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To summarize what we did in this exercise:</p>
<ul>
<li><p>we were interested in investigating a full SEM model (with both a measurement model and a structural model), in two groups</p></li>
<li><p>before we could investigate the structural part of the model (i.e., the latent regression), we had to determine whether there was measurement invariance across the groups</p></li>
<li><p>to this end we ran a series of three models: configural invariance, weak factorial invariance and strong factorial invariance; these models are increasingly more restrictive, and we compared each subsequent model with the preceding one (using a chi-square different test) to see whether the additional constraints were tenable</p></li>
<li><p>since neither of the two chi-square difference test reached significance, we can conclude that strong factorial invariance holds; this means we are measuring the same constructs in both groups, and we can compare their latent means</p></li>
<li><p>we also considered an alternative way to scale the models (based on setting one of the intercepts per factor to zero, rather than the latent means), which more clearly shows that the model for strong factorial invariance is a special case of the model for weak factorial invariance</p></li>
<li><p>the first way of scaling has the advantage that we can immediately see whether the means of the two groups on the latent variables differ or not; here we found no significant difference</p></li>
<li><p>since the latent variables are measured in the same way in both groups, we continue with our actual research question, which concerns the latent regression model; regressing the latent variables on each other resulted in a model that is equivalent to the model for strong factorial invariance</p></li>
<li><p>subsequently, we constrained the regression coefficient across the two groups to see whether the effect of family of origin (FO) has the same effect on marital adjustment (MA) in the two groups; again, by doing a chi-square difference test we could determine whether or not this constraint was tenable; since the test was not significant, we may assume that the two regression slopes are the same across the groups</p></li>
<li><p>note that in the end, we still have the same warning as for the first model about a Heywood case (negative variance) in the first group; we should present such results in a paper; we could constrain this variance to zero (and we could do the same thing in the other group, because it is not significantly different from zero there either), which would make this indicator and the latent variable it measures identical; put differently, this implies that we can measure marital adjustment with this one variable, and we do not need the other one for it</p></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="day-1-mplus-and-the-lisrel-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="path-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["S23.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
