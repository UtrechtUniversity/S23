<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Utrecht Summer School (S23) - Part 2: Studying Cross-Lagged Panel Models using Monte Carlo Simulations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./day4_CLPMvRICLPM.html">Day 4</a></li><li class="breadcrumb-item"><a href="./day4_monteCarlo.html">Part 2: Studying Cross-Lagged Panel Models using Monte Carlo Simulations</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Utrecht Summer School (S23)</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Day 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day1_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day1_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Day 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day2_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day2_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Day 3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day3_part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 1: Latent Class Analysis and Latent Transition Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day3_part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 2: Latent growth (mixture) modeling</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Day 4</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day4_CLPMvRICLPM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 1: The CLPM and RI-CLPM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day4_monteCarlo.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Part 2: Studying Cross-Lagged Panel Models using Monte Carlo Simulations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Day 5</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day5_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day5_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#exercise-1-the-traditional-cross-lagged-panel-model" id="toc-exercise-1-the-traditional-cross-lagged-panel-model" class="nav-link active" data-scroll-target="#exercise-1-the-traditional-cross-lagged-panel-model">Exercise 1: The traditional Cross-Lagged Panel Model</a>
  <ul class="collapse">
  <li><a href="#exercise-1a-what-to-expect" id="toc-exercise-1a-what-to-expect" class="nav-link" data-scroll-target="#exercise-1a-what-to-expect">Exercise 1A: What to expect?</a></li>
  <li><a href="#exercise-1b-simulation-results-for-cross-lagged-effect-x-to-y" id="toc-exercise-1b-simulation-results-for-cross-lagged-effect-x-to-y" class="nav-link" data-scroll-target="#exercise-1b-simulation-results-for-cross-lagged-effect-x-to-y">Exercise 1B: Simulation results for cross-lagged effect <code>X</code> to <code>Y</code></a></li>
  <li><a href="#exercise-1c-simulation-results-for-cross-lagged-effect-y-to-x" id="toc-exercise-1c-simulation-results-for-cross-lagged-effect-y-to-x" class="nav-link" data-scroll-target="#exercise-1c-simulation-results-for-cross-lagged-effect-y-to-x">Exercise 1C: Simulation results for cross-lagged effect <code>Y</code> to <code>X</code></a></li>
  </ul></li>
  <li><a href="#exercise-2-the-random-intercept-cross-lagged-panel-model" id="toc-exercise-2-the-random-intercept-cross-lagged-panel-model" class="nav-link" data-scroll-target="#exercise-2-the-random-intercept-cross-lagged-panel-model">Exercise 2: The Random Intercept Cross-Lagged Panel Model</a>
  <ul class="collapse">
  <li><a href="#exercise-2a-simulation-ri-clpm-vs.-clpm" id="toc-exercise-2a-simulation-ri-clpm-vs.-clpm" class="nav-link" data-scroll-target="#exercise-2a-simulation-ri-clpm-vs.-clpm">Exercise 2A: Simulation RI-CLPM vs.&nbsp;CLPM</a></li>
  <li><a href="#exercise-2b-simulation-ri-clpm-vs.-clpm" id="toc-exercise-2b-simulation-ri-clpm-vs.-clpm" class="nav-link" data-scroll-target="#exercise-2b-simulation-ri-clpm-vs.-clpm">Exercise 2B: Simulation RI-CLPM vs.&nbsp;CLPM</a></li>
  </ul></li>
  <li><a href="#exercise-3-the-stable-trait-autoregressive-trait-state-model" id="toc-exercise-3-the-stable-trait-autoregressive-trait-state-model" class="nav-link" data-scroll-target="#exercise-3-the-stable-trait-autoregressive-trait-state-model">Exercise 3: The Stable Trait Autoregressive Trait State model</a>
  <ul class="collapse">
  <li><a href="#exercise-3a-fitting-the-starts-model-i" id="toc-exercise-3a-fitting-the-starts-model-i" class="nav-link" data-scroll-target="#exercise-3a-fitting-the-starts-model-i">Exercise 3A: Fitting the STARTS model I</a></li>
  <li><a href="#exercise-3b-ignoring-measurement-error" id="toc-exercise-3b-ignoring-measurement-error" class="nav-link" data-scroll-target="#exercise-3b-ignoring-measurement-error">Exercise 3B: Ignoring measurement error</a></li>
  <li><a href="#exercise-3c-fitting-the-starts-model-ii" id="toc-exercise-3c-fitting-the-starts-model-ii" class="nav-link" data-scroll-target="#exercise-3c-fitting-the-starts-model-ii">Exercise 3C: Fitting the STARTS model II</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Part 2: Studying Cross-Lagged Panel Models using Monte Carlo Simulations</h1>
<p class="subtitle lead">Day 4: Causal Inference in Cross-Lagged Panel Research</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In the second part of the computer lab, we will be studying statistical properties of various cross-lagged panel models using the Monte Carlo functionality of Mplus. This is a somewhat different approach than the previous days of this course, but nevertheless very insightful. A useful source of information for performing simulation studies using Mplus is the Mplus User Guide, <a href="https://statmodel.com/download/usersguide/Chapter12.pdf">Chapter 12</a>. The answer input files can be found on SURFdrive.</p>
<section id="exercise-1-the-traditional-cross-lagged-panel-model" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-the-traditional-cross-lagged-panel-model">Exercise 1: The traditional Cross-Lagged Panel Model</h2>
<p>First, lets get ourselves acquainted with performing simulations in Mplus. Suppose want to study the power for detecting a nonzero cross-lagged effect in the traditional cross-lagged panel model. Such questions concerning power can also be investigated using simulations. In these cases, the population model (the model from which the data is generated) is the same as the estimation model. We then generate data with a nonzero cross-lagged effect, and estimate the CLPM on the generated data. We hope, of course, that the fitted CLPM returns a significant cross-lagged effect; if not, this would be a Type II error (i.e., not finding a significant effect, whereas we know there is one).</p>
<section id="exercise-1a-what-to-expect" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1a-what-to-expect">Exercise 1A: What to expect?</h3>
<p>Before running the simulation study, let us think about what results we expect. We are using the same model for data generation and estimation. Do we expect bias in the parameter estimates? If we are testing significance with a significance level of <span class="math inline">\(\alpha = 0.05\)</span>, what should be the 95% coverage rate for the parameters?</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When the population model and the estimation model are the same, we do not expect a bias in the parameter estimates, nor in the standard errors of the parameter estimates. In Mplus, you get the average (average across all replications) estimate for each parameter. This average should be very close to the population values (i.e., the Truth). In this situation, the 95% coverage rate should be close to 95%. This means that in 95% of the replications, the confidence interval around the parameter estimates contains the population value. This is actually the definition of a confidence interval.</p>
</div>
</div>
</div>
</section>
<section id="exercise-1b-simulation-results-for-cross-lagged-effect-x-to-y" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1b-simulation-results-for-cross-lagged-effect-x-to-y">Exercise 1B: Simulation results for cross-lagged effect <code>X</code> to <code>Y</code></h3>
<p>Open the file MonteCarlo_template.inp, which is a template for Monte Carlo studies in Mplus. Complete the template to perform a power analysis for the traditional CLPM, for a sample size of 500, and a cross-lagged effect of <code>X</code> to <code>Y</code> of 0.2. For the <code>MONTECARLO:</code> command, name the variables to be created <code>x1-x4</code> and <code>y1-y4</code>. Set the number of replications to a thousand, and set a seed.</p>
<p>For the <code>MODEL POPULATION:</code> command, define a traditional CLPM. Set the autoregressive effects of <code>X</code> to 0.3, and thoses of <code>Y</code> to 0.5. Set the cross-lagged effects of <code>Y</code> to <code>X</code> to 0.05, and those from <code>X</code> to <code>Y</code> to 0.2 (i.e., the parameter that we want to compute the power for). Set the variances of <code>X</code> and <code>Y</code> at the first wave to 1, and its covariance to 0.3. Set the residual variances of <code>X</code> to 0.9015, and those of <code>Y</code> to 0.670; set the residual covariances to 0.083. The mean structure can be set to 0 for all variables.</p>
<p>For the <code>MODEL:</code> command, define the same model. However, don’t use the <code>@</code> symbol to fix parameter to particular values (as done in <code>MODEL POPULATION:</code>), but use the asterisk <code>*</code> to indicate what the parameter values <em>should</em> be. This way the parameters are estimates, but in the output file, Mplus knows what value (i.e., what Truth) the parameter values should be compared to.</p>
<p>Run the simulations, and assess the bias, 95% coverage rate, and power for the cross-lagged effect of <code>X</code> to <code>Y</code>.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Bias, coverage rate, and power can be read off in the <code>MODEL RESULTS</code> part of the output. For bias, we need to compare the average estimate to the population value. Because simulation studies contain a random component, the results are likely to be slighlty different for everyone (unless you use the same seed). However, the average estimate of each parameter approximately the same as their population values. The 95% coverage rates should all be approximately 95%. Power is defined as the percentage of times that the nonzero parameter is actually estimated to be significantly different from 0. For a cross-lagged effect of 0.2 and a sample size of <code>n = 500</code>, the power should be approximately 1.</p>
</div>
</div>
</div>
</section>
<section id="exercise-1c-simulation-results-for-cross-lagged-effect-y-to-x" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1c-simulation-results-for-cross-lagged-effect-y-to-x">Exercise 1C: Simulation results for cross-lagged effect <code>Y</code> to <code>X</code></h3>
<p>Now look at the smaller cross-lagged effect, that of <code>Y</code> to <code>X</code>. What is the power for an effect of <code>0.05</code>, given this sample size? Suppose that we have some missing data, how will this affect the power of this parameter?</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The cross-lagged effect of <code>Y</code> to <code>X</code> is set to be a smaller effect size. Therefore, we can also see that the power is much smaller, approximately around 0.20 to 0.23. If we have missing data, this implies your sample size is smaller, and the power will therefore decrease.</p>
</div>
</div>
</div>
</section>
</section>
<section id="exercise-2-the-random-intercept-cross-lagged-panel-model" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-the-random-intercept-cross-lagged-panel-model">Exercise 2: The Random Intercept Cross-Lagged Panel Model</h2>
<p>Now, let us investigate what can go wrong if the data actually have some stable, between-person differences in them, but we do not account for this when analyzing the data. More specifically, what happens when we generate data with the RI-CLPM, but fit the traditional CLPM to the data? This is a case that was investigated at length by <span class="citation" data-cites="hamaker_critique_2015">Hamaker, Kuiper, and Grasman (<a href="#ref-hamaker_critique_2015" role="doc-biblioref">2015</a>)</span>.</p>
<section id="exercise-2a-simulation-ri-clpm-vs.-clpm" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2a-simulation-ri-clpm-vs.-clpm">Exercise 2A: Simulation RI-CLPM vs.&nbsp;CLPM</h3>
<p>Adjust the Mplus input file that you created for Exercise 1. This time, in the <code>MODEL POPULATION:</code> command, define an RI-CLPM. Set the variances of the random intercept factors for <code>X</code> and <code>Y</code> to 1, and their covariance to 0.4. Create within-components, and set the autoregressions of the within-components for <code>X</code> to 0.15, and the autoregressions of the within-components of <code>Y</code> to 0.25. For the cross-lagged effects between the within-components, let those from <code>X</code> to <code>Y</code> be 0.2 again, and the other way around 0.05. Set the variances of the within-components of <code>X</code> and <code>Y</code> at the first wave to 1, and its covariance to 0.3. Set the residual variances of the within-components of <code>X</code> to 0.972, and those of <code>Y</code> to 0.8775; set the residual covariances to 0.148. The mean structure can be set to 0 for all variables.</p>
<p>For the <code>MODEL:</code> command, define the traditional CLPM. However, don’t use the <code>@</code> symbol to fix parameter to particular values (as done in <code>MODEL POPULATION:</code>), but use the asterisk <code>*</code> to indicate what the parameter values <em>should</em> be.</p>
<p>Run the simulations, and assess the bias of (a) the autoregressive effects, and (b) the cross-lagged effects.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This situation is a case of model misspecification (which can also happen of course in reality). We see that the autoregressive effects are estimated to be much higher on average (the average is approximately 0.50-0.60 for <code>X</code> and approximately 0.55-0.65 for <code>Y</code>) than they should be. In other words, the autoregressive effects in the CLPM are biased when the data are actually generated by the RI-CLPM. The reason why the CLPM autoregressive effects are much higher is that these parameters now need to account not only for moment-to-moment stability, but also stability across the study span (i.e., the stability due to the random intercept factor). When analyzing empirical data, this is a phenomenon we commonly see: The autoregressive effects are estimated to be much smaller when analyzing data with the RI-CLPM, compared to analysis using the traditional CLPM.</p>
<p>Similarly, there is bias for the cross-lagged effects, but there is not a clear pattern here. For the cross-lagged effects of <code>X</code>to <code>Y</code>, the bias is towards to 0, whereas for the cross-lagged effect of <code>Y</code> to <code>X</code> the bias is away from 0.</p>
<p>These finding are in line with <span class="citation" data-cites="hamaker_critique_2015">Hamaker, Kuiper, and Grasman (<a href="#ref-hamaker_critique_2015" role="doc-biblioref">2015</a>)</span>, who concludes that using the traditional CLPM when the data are actually generated by the RI-CLPM, you may:</p>
<ul>
<li>find spurious effects;</li>
<li>fail to detect relationships;</li>
<li>identify the wrong variable as being causally dominant; or</li>
<li>obtain the wrong sign for an effect.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="exercise-2b-simulation-ri-clpm-vs.-clpm" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2b-simulation-ri-clpm-vs.-clpm">Exercise 2B: Simulation RI-CLPM vs.&nbsp;CLPM</h3>
<p>Now, you might wonder what happens the other way around: What if we analyze data without stable, between-person differences, with the RI-CLPM? We will study this case now. Specify the population model from Exercise 1B, but analyse the generated data using the RI-CLPM. Assess the bias of the lagged effects.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Adjust the “starting value” of model under the <code>MODEL:</code> command accordingly. Otherwise, in the Mplus output, the parameter estimates are compared to the wrong population parameter values. For example, you would expect that the variances of the random intercept factors are 0 when the data were generated under the traditional CLPM.</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There appears to be no bias in the lagged effects of the RI-CLPM, even when the data were generated by the traditional CLPM. This is to be expected as the traditional CLPM is nested under the RI-CLPM.</p>
</div>
</div>
</div>
</section>
</section>
<section id="exercise-3-the-stable-trait-autoregressive-trait-state-model" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3-the-stable-trait-autoregressive-trait-state-model">Exercise 3: The Stable Trait Autoregressive Trait State model</h2>
<p>Measurement error in measurements in psychology (and related disciplines) is the rule, rather than the exception. Therefore, we would ideally like to control for measurement error (as well as stable, between-person differences). This can be done using the Stable Trait Autoregressive Trait State (STARTS) model.</p>
<section id="exercise-3a-fitting-the-starts-model-i" class="level3">
<h3 class="anchored" data-anchor-id="exercise-3a-fitting-the-starts-model-i">Exercise 3A: Fitting the STARTS model I</h3>
<p>Adjust the Mplus input file of Exercise 2A. This time, in <code>MODEL POPULATION:</code>, rather than fixing the measurement error variances to 0, fix the measurement error to 0.6. Given the same population parameter values of the other parameters in the model, this would imply a reliability of 0.7 of the single indicator (i.e., 30% measurement error variance, 70% true score variance). For the estimation in the <code>MODEL:</code> command, specify the STARTS model as well. Compared to the RI-CLPM, this implies simply freeing up the measurement error variances.</p>
<p>Check the <code>MODEL RESULTS</code> in the output. What do you notice?</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As mentioned in the lecture, the STARTS model is notoriously hard to estimate. In fact, the model results will likely show only zeros. This is because in none of replications, the STARTS model actually converged. This can be seen in the <code>SUMMARY OF ANALYSIS</code> part in the output, see “Number of replications” and then “Completed”.</p>
</div>
</div>
</div>
</section>
<section id="exercise-3b-ignoring-measurement-error" class="level3">
<h3 class="anchored" data-anchor-id="exercise-3b-ignoring-measurement-error">Exercise 3B: Ignoring measurement error</h3>
<p>Okay, that was annoying. But perhaps we can simply ignore measurement error? We can investigate if this has any effect on the estimates of interest, the lagged effects. Setup a simulation study to investigate potential bias in the estimates of the RI-CLPM, when the data actually contain measurement error. More specifically, generate data using the STARTS, but analyse the data using the RI-CLPM. What is the effect of unmodelled measurement error on the lagged effects of the RI-CLPM?</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To study this research question, you can specify the STARTS model in the <code>MODEL POPULATION:</code> command, and specify the RI-CLPM under <code>MODEL:</code>. When looking at the model results, we can see that ignoring measurement error it not a good idea: The lagged effects are biased. However, there does appear to be a consistent pattern here: The lagged effects are estimated to be smaller than they should be (i.e., there is bias towards 0). This implies that in this particular situation, it is possible that we miss nonzero effects that are actually in the data (but that we estimate to be close to zero because of the unmodelled measurement error).</p>
</div>
</div>
</div>
</section>
<section id="exercise-3c-fitting-the-starts-model-ii" class="level3">
<h3 class="anchored" data-anchor-id="exercise-3c-fitting-the-starts-model-ii">Exercise 3C: Fitting the STARTS model II</h3>
<p>Let’s see what we can do to actually make the STARTS model, from Exercise 3A, converge. Try out several options, and see if you can get simulation results. For example, try increasing the sample size, imposing constraints on the measurement error variances of time, using a Bayesian estimator, or a combination of these.</p>
<ul>
<li><em>Imposing constraints</em>. By imposing constraints on parameters, you make the estimation model simpler, and therefore Mplus can use the same amount of information to estimate fewer parameters. Think about what are sensible constraints to impose on the model. For example, would you constrain all measurement error variances to be the same in the model, or is it more sensible to constrain the measurement error variances of <code>X</code> and <code>Y</code> separately?</li>
<li><em>Increase sample size</em>. Increasing the sample size might help, although you could ask if in practice increases in sample size are worth the effort? Perhaps it is more useful to collect additional waves of data, rather than collecting additional persons?</li>
<li><em>Bayesian</em>. Bayesian estimation is a different statistical framework, that for estimation not only relies on the likelihood of the data, but also on prior information. <span class="citation" data-cites="ludtke_bayesian_2023">Lüdtke, Robitzsch, and Ulitzsch (<a href="#ref-ludtke_bayesian_2023" role="doc-biblioref">2023</a>)</span> and <span class="citation" data-cites="ludtke_more_2018">Lüdtke, Robitzsch, and Wagner (<a href="#ref-ludtke_more_2018" role="doc-biblioref">2018</a>)</span> have demonstrated how the STARTS model can be estimated in a Bayesian framework. Of specific interest here is the specification of the priors. For now, you can check out the simulation results by relying on the default prior in Mplus.</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Bayesian estimation relies on sampling from the posterior distribution, and can be incredibly slow, especially for difficult to fit models like the STARTS model. Try out what happens when you go Bayesian. You can always stop the Mplus operations by pressing Control-C in the MS-DOS window, or pressing the X.</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The SURFdrive folder contains Mplus output files for each of these scenarios.</p>
<ul>
<li><em>Imposing constraints</em>. One option would be to constrain the measurement error variances over time for the <code>X</code> and <code>Y</code> variables separately. This might be more plausible than constraining all measurement error variances to be equal to each other, considering that <code>X</code> and <code>Y</code> are different measures. Imposing this constraint, as well as increasing the sample size to 1000, does aid convergence. The completed number of replications has now increased to 300-400, although this is still far from satisfactory. The convergence issues also in the model results, which still shows biased results. If all STARTS models had converged, then we should have no bias. Clearly, imposing constraints itself is not enough to help convergence in this particular situation.</li>
<li><em>Increase sample size</em>. Increasing sample size even to 10000 does not help the situation: There are still no completed replications. An alternative might be to increase both the sample size, and the number of repeated measures.</li>
<li><em>Bayesian</em>. We can invoke Bayesian estimation in the <code>ANALYSIS:</code> command by including <code>ESTIMATOR = BAYES;</code>. On its own, this option is not enough. Convergence is incredibly slow, let alone running 1000 replications. Therefore you might try both combining imposing the constraints, and adjusting the prior specification as recommended by <span class="citation" data-cites="ludtke_bayesian_2023">Lüdtke, Robitzsch, and Ulitzsch (<a href="#ref-ludtke_bayesian_2023" role="doc-biblioref">2023</a>)</span>.</li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Using simulations in Mplus, we have studied some characteristics of popular cross-lagged panel models. Such simulations are useful to develop some intuition of how these models compare, and what happens when there is model misspecification (when the <code>MODEL POPULATION:</code> does not match the <code>MODEL:</code>). In reality, however, we do not know which model was the true population model. Based on theory and literature, we can of course reason about the presence of, for example, measurement error and unobserved heterogeneity, but there will always remain some residual uncertainty. This is one of the major challenges that applied researchers face.</p>
<p>These simulations have just been the tip of the iceberg. They can be extended to investigate all kinds of other scenario’s, for example, the impact of nonlinear relationships on estimates from linear cross-lagged panel models, the bias of parameter estimates in the presence of unmeasured confounding, etc. However, these scenario’s can become quite complex, and careful planning is needed to setup a simulation study,and to draw valid conclusions from it.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-hamaker_critique_2015" class="csl-entry" role="listitem">
Hamaker, Ellen L., Rebecca M. Kuiper, and Raoul P. P. P. Grasman. 2015. <span>“A Critique of the Cross-Lagged Panel Model.”</span> <em>Psychological Methods</em> 20 (1): 102–16. <a href="https://doi.org/10.1037/a0038889">https://doi.org/10.1037/a0038889</a>.
</div>
<div id="ref-ludtke_bayesian_2023" class="csl-entry" role="listitem">
Lüdtke, Oliver, Alexander Robitzsch, and Esther Ulitzsch. 2023. <span>“A <span>Bayesian</span> Approach to Estimating Reciprocal Effects with the Bivariate <span>STARTS</span> Model.”</span> <em>Multivariate Behavioral Research</em> 58 (3): 560–79. <a href="https://doi.org/10.1080/00273171.2022.2039585">https://doi.org/10.1080/00273171.2022.2039585</a>.
</div>
<div id="ref-ludtke_more_2018" class="csl-entry" role="listitem">
Lüdtke, Oliver, Alexander Robitzsch, and Jenny Wagner. 2018. <span>“More Stable Estimation of the <span>STARTS</span> Model: <span>A</span> <span>Bayesian</span> Approach Using <span>Markov</span> Chain <span>Monte</span> <span>Carlo</span> Techniques.”</span> <em>Psychological Methods</em> 23 (3): 570–93. <a href="https://doi.org/10.1037/met0000155">https://doi.org/10.1037/met0000155</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>